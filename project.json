{
  "project": {
    "name": "PHPaibot",
    "description": "A proactive PHP chatbot that simulates human-like thinking by generating thoughts, maintaining memory, and evolving personality with news-aware emotional intelligence",
    "version": "0.4.0",
    "repository": "https://github.com/username/PHPaibot",
    "status": "Phase 3 In Progress - Profile store, admin controls, UI served from webhook API; expanding structured facts and NLP-enhanced extraction"
  },
  "architecture": {
    "overview": "Hybrid push/pull chat system with QDRANT vector database, news processing, and emotional state tracking. Uses remote LLM and embedding endpoints. Proactive thoughts are dynamically generated and influenced by current events.",
    "components": {
      "conversationalLoop": {
        "description": "Fast, reactive chat system using QDRANT for semantic search.",
        "implementation": "Node.js backend handles chat requests, retrieves context from QDRANT, and calls remote LLM.",
        "files": ["webhook-api/server.js", "index.html"],
        "status": "Implemented"
      },
      "cognitiveLoop": {
        "description": "Dynamic thought generation system that creates contextual, news-aware proactive thoughts.",
        "implementation": "LLM-powered thought generation with news-influenced augmentation. Separates proactive thoughts from conversational responses.",
        "status": "Implemented"
      },
      "memorySystem": {
        "description": "QDRANT vector database for semantic conversation storage and retrieval.",
        "implementation": "Stores conversations and news context with embeddings. Supports semantic search and filtering.",
        "status": "Implemented"
      },
      "newsProcessing": {
        "description": "Automated news feed processing with emotional analysis and mood tracking.",
        "implementation": "Processes RSS feeds, analyzes sentiment, updates mood state (-10 to +10), and stores context in QDRANT.",
        "files": ["webhook-api/news-processor.js", "webhook-api/news-data.json"],
        "status": "Implemented"
      },
      "emotionalIntelligence": {
        "description": "Mood system that tracks AI emotional state based on news sentiment.",
        "implementation": "Maintains mood score and topic memory. Influences thought generation and conversation style.",
        "status": "Implemented"
      },
      "infrastructureComponents": {
        "description": "Docker-based infrastructure with external service integration.",
        "implementation": "Docker Compose with optional QDRANT and external LLM/embedding endpoints.",
        "components": [
          {"name": "QDRANT vector database", "status": "Implemented", "url": "http://192.168.5.227:6333/"},
          {"name": "Remote LLM/Embedding endpoints", "status": "Configured via env", "note": "Set LLM_URL and EMBEDDING_URL"},
          {"name": "Node.js webhook API", "status": "Implemented"},
          {"name": "PHP Web server", "status": "Implemented"}
        ],
        "status": "Partially Provisioned - requires external services or dev-mock"
      }
    }
  },
  "developmentPlan": {
    "currentPhase": 3,
    "phases": [
      {
        "number": 1,
        "name": "Infrastructure Setup & Core Conversational Loop",
        "description": "Deploy infrastructure and implement basic chat functionality with memory.",
        "tasks": [
          {"name": "Create Docker Compose configuration", "status": "Completed"},
          {"name": "Implement WebSocket push-based frontend", "status": "Completed"},
          {"name": "Implement Node.js backend with API and WebSocket server", "status": "Completed"},
          {"name": "Externalize AI models to remote Ollama endpoint", "status": "Completed"},
          {"name": "Integrate QDRANT vector database", "status": "Completed"},
          {"name": "Implement conversational memory with context retrieval", "status": "Completed"},
          {"name": "Implement idle timer for proactive thoughts", "status": "Completed"}
        ],
        "deliverables": ["Working chatbot with contextual memory and proactive engagement."],
        "status": "Completed"
      },
      {
        "number": 2,
        "name": "The Thinker",
        "description": "Implement dynamic proactive thought generation with news awareness.",
        "tasks": [
          {"name": "Replace hardcoded thought list with dynamic LLM-based generation", "status": "Completed"},
          {"name": "Create news processing system for RSS feeds", "status": "Completed"},
          {"name": "Implement emotional state tracking and mood system", "status": "Completed"},
          {"name": "Integrate news sentiment analysis into thought generation", "status": "Completed"},
          {"name": "Separate proactive thoughts from conversational responses", "status": "Completed"},
          {"name": "Add automated news processing with cron scheduling", "status": "Completed"}
        ],
        "deliverables": ["Chatbot that initiates conversations based on current events and emotional state."],
        "status": "Completed"
      },
      {
        "number": 3,
        "name": "Personality & Evolution",
        "description": "Add adaptive personality and learning mechanisms.",
        "tasks": [
          {"name": "Add Profile store for user/bot personality traits", "status": "Implemented"},
          {"name": "Create feedback loops for continuous learning", "status": "In Progress"},
          {"name": "Develop opinion formation mechanisms", "status": "In Progress"},
          {"name": "Implement long-term memory and relationship tracking", "status": "Planned"},
          {"name": "Add personality adaptation based on user interactions", "status": "In Progress"},
          {"name": "Expand structured fact extraction and discovery question system", "status": "In Progress"},
          {"name": "Add optional NLP/NER and embedding-backed confirmation flow", "status": "Planned"}
        ],
        "deliverables": ["Chatbot that adapts and develops personality over time and reliably learns user facts."],
        "status": "In Progress"
      }
    ]
  },
  "currentCapabilities": [
    "Dynamic thought generation using LLM",
    "News-aware personality with RSS integration",
    "Emotional state tracking (-10 to +10 mood scale)",
    "Context-aware conversations using QDRANT semantic search",
    "Proactive engagement with natural conversation flow",
    "Real-time WebSocket communication",
    "Automated news processing every 30 minutes",
    "Sentiment analysis and topic extraction",
    "Runtime dev-mock mode for local testing and admin toggle",
    "Structured fact memory that captures user-specific details (name, favorites, attributes) from conversations",
    "Profile question history and discovery flow (basic)",
    "Password-protected profiles that sync identities across devices",
    "Role-aware UI (admin vs user) with gated controls",
    "Authenticated UI boot flow that waits for a valid session before enabling `/`/`/chat` interactions"
  ],
  "apiEndpoints": [
    {"endpoint": "/api/chat", "method": "POST", "description": "Main chat interface (requires user session headers)"},
    {"endpoint": "/api/mood", "method": "GET", "description": "Check AI emotional state and topics"},
    {"endpoint": "/api/process-news", "method": "GET/POST", "description": "Trigger manual news processing (admin headers required)"},
    {"endpoint": "/api/admin/dev-mock", "method": "GET/POST", "description": "View and toggle development mock mode (admin only)"},
    {"endpoint": "/api/users/:userId/profile", "method": "GET", "description": "Retrieve user profile"},
    {"endpoint": "/admin", "method": "GET", "description": "Serve admin dashboard to authenticated admins"},
    {"endpoint": "/", "method": "GET", "description": "Redirects to `/chat` once authentication completes"},
    {"endpoint": "/chat", "method": "GET", "description": "Serve chat UI from webhook API (same origin)"}
  ],
  "nextSteps": [
    "Finish feedback loops for continuous learning",
    "Harden admin endpoints with authentication",
    "Expand structured fact extraction patterns and templates",
    "Add an embedding-backed confirmation flow for low-confidence facts",
    "Integrate optional NLP/NER service for improved extraction",
    "Add automated tests for fact extraction and question flow",
    "Deploy production LLM/EMBEDDING endpoint and disable dev-mock"
  ],
  "statusDetails": {
    "externalServices": {
      "qdrant": "Specify QDRANT_URL (e.g. http://host:6333) - required",
      "llm": "Specify LLM_URL (OpenAI-compatible) - required if dev-mock is disabled",
      "embeddings": "Specify EMBEDDING_URL (OpenAI-compatible) - required if dev-mock is disabled",
      "searxng": "Optional - URL for RSS parsing if used"
    },
    "requiredEnv": [
      "LLM_URL",
      "EMBEDDING_URL",
      "QDRANT_URL",
      "PORT (optional)",
      "DEV_MOCK (optional)"
    ],
    "authentication": {
      "description": "`/` and `/chat` wait for a valid session (userId + token) before opening WebSockets or hitting `/api/chat`, and every admin endpoint (`/api/process-news`, `/api/admin/*`, `/admin`) rejects requests without `X-User-Id`/`X-Auth-Token`.",
      "notes": "Ensure the client stores the session from `/api/auth/login` or `/api/auth/register` so the UI can complete its boot sequence. Admin dashboards rely on the same token via query params to `/admin`."
    },
    "notes": "This project can run in a local dev-mock mode (DEV_MOCK=true or via admin toggle) for testing without external LLM/embedding services. For production, configure real services and disable dev-mock."
  },
  "lastUpdated": "2025-11-24T00:00:00Z"
}
