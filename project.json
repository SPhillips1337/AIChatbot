{
  "project": {
    "name": "AURA.ai Chatbot",
    "description": "A proactive AI chatbot that simulates human-like thinking by generating thoughts, maintaining memory, and evolving personality with news-aware emotional intelligence",
    "version": "0.8.0",
    "repository": "https://github.com/SPhillips1337/AIChatbot.git",
    "status": "Phase 3 Complete - Production-ready with external Qdrant cloud database, relationship tracking, hardened error handling, rate limiting, and improved chat logic"
  },
  "architecture": {
    "overview": "Hybrid push/pull chat system with QDRANT vector database, news processing, and emotional state tracking. Uses remote LLM and embedding endpoints. Proactive thoughts are dynamically generated and influenced by current events.",
    "components": {
      "conversationalLoop": {
        "description": "Fast, reactive chat system using QDRANT for semantic search.",
        "implementation": "Node.js backend handles chat requests, retrieves context from QDRANT, and calls remote LLM.",
        "files": ["webhook-api/server.js", "index.html"],
        "status": "Implemented"
      },
      "cognitiveLoop": {
        "description": "Dynamic thought generation system that creates contextual, news-aware proactive thoughts.",
        "implementation": "LLM-powered thought generation with news-influenced augmentation. Separates proactive thoughts from conversational responses.",
        "status": "Implemented"
      },
      "memorySystem": {
        "description": "QDRANT vector database for semantic conversation storage and retrieval.",
        "implementation": "Stores conversations and news context with embeddings. Supports semantic search and filtering.",
        "status": "Implemented"
      },
      "newsProcessing": {
        "description": "Automated news feed processing with emotional analysis and mood tracking.",
        "implementation": "Processes RSS feeds, analyzes sentiment, updates mood state (-10 to +10), and stores context in QDRANT.",
        "files": ["webhook-api/news-processor.js", "webhook-api/news-data.json"],
        "status": "Implemented"
      },
      "emotionalIntelligence": {
        "description": "Mood system that tracks AI emotional state based on news sentiment.",
        "implementation": "Maintains mood score and topic memory. Influences thought generation and conversation style.",
        "status": "Implemented"
      },
      "relationshipSystem": {
        "description": "JSON-based relationship tracking for user connections and shared interests.",
        "implementation": "Extended profileStore.js with relationship tracking and shared interest discovery.",
        "files": ["webhook-api/profileStore.js"],
        "status": "Implemented"
      },
      "productionHardening": {
        "description": "Rate limiting, memory management, service health monitoring, and error handling.",
        "implementation": "Rate limiter, health checker, connection cleanup, and robust JSON parsing.",
        "files": ["webhook-api/rateLimiter.js", "webhook-api/healthChecker.js"],
        "status": "Implemented"
      },
      "infrastructureComponents": {
        "description": "Cloud-based infrastructure with external service integration.",
        "implementation": "External Qdrant cloud database with remote LLM/embedding endpoints.",
        "components": [
          {"name": "QDRANT cloud database", "status": "Implemented", "url": "External cloud instance", "note": "Migrated from local to cloud with API key authentication"},
          {"name": "Remote LLM/Embedding endpoints", "status": "Configured via env", "note": "Set LLM_URL and EMBEDDING_URL"},
          {"name": "Node.js webhook API", "status": "Implemented"},
          {"name": "PHP Web server", "status": "Implemented"}
        ],
        "status": "Fully Provisioned"
      }
    }
  },
  "developmentPlan": {
    "currentPhase": 3,
    "phases": [
      {
        "number": 1,
        "name": "Infrastructure Setup & Core Conversational Loop",
        "description": "Deploy infrastructure and implement basic chat functionality with memory.",
        "tasks": [
          {"name": "Create Docker Compose configuration", "status": "Completed"},
          {"name": "Implement WebSocket push-based frontend", "status": "Completed"},
          {"name": "Implement Node.js backend with API and WebSocket server", "status": "Completed"},
          {"name": "Externalize AI models to remote Ollama endpoint", "status": "Completed"},
          {"name": "Integrate QDRANT vector database", "status": "Completed"},
          {"name": "Implement conversational memory with context retrieval", "status": "Completed"},
          {"name": "Implement idle timer for proactive thoughts", "status": "Completed"}
        ],
        "deliverables": ["Working chatbot with contextual memory and proactive engagement."],
        "status": "Completed"
      },
      {
        "number": 2,
        "name": "The Thinker",
        "description": "Implement dynamic proactive thought generation with news awareness.",
        "tasks": [
          {"name": "Replace hardcoded thought list with dynamic LLM-based generation", "status": "Completed"},
          {"name": "Create news processing system for RSS feeds", "status": "Completed"},
          {"name": "Implement emotional state tracking and mood system", "status": "Completed"},
          {"name": "Integrate news sentiment analysis into thought generation", "status": "Completed"},
          {"name": "Separate proactive thoughts from conversational responses", "status": "Completed"},
          {"name": "Add automated news processing with cron scheduling", "status": "Completed"}
        ],
        "deliverables": ["Chatbot that initiates conversations based on current events and emotional state."],
        "status": "Completed"
      },
      {
        "number": 3,
        "name": "Personality & Evolution",
        "description": "Add adaptive personality and learning mechanisms with production hardening.",
        "tasks": [
          {"name": "Add Profile store for user/bot personality traits", "status": "Completed"},
          {"name": "Create feedback loops for continuous learning", "status": "Completed"},
          {"name": "Develop opinion formation mechanisms", "status": "Completed"},
          {"name": "Implement long-term memory and relationship tracking", "status": "Completed"},
          {"name": "Add personality adaptation based on user interactions", "status": "Completed"},
          {"name": "Expand structured fact extraction and discovery question system", "status": "Completed"},
          {"name": "Add embedding-backed confirmation and inline profile UI", "status": "Completed"},
          {"name": "Add telemetry collection and admin telemetry UI", "status": "Completed"},
          {"name": "Implement production hardening (rate limiting, error handling)", "status": "Completed"},
          {"name": "Add relationship tracking system", "status": "Completed"},
          {"name": "Improve chat logic to reduce intrusive mood/news injection", "status": "Completed"}
        ],
        "deliverables": ["Production-ready chatbot that adapts personality over time and reliably learns user facts."],
        "status": "Completed"
      }
    ]
  },
  "currentCapabilities": [
    "Dynamic thought generation using LLM",
    "News-aware personality with RSS integration",
    "Emotional state tracking (-10 to +10 mood scale)",
    "Context-aware conversations using QDRANT semantic search",
    "Proactive engagement with natural conversation flow",
    "Real-time WebSocket communication",
    "Automated news processing every 30 minutes",
    "Sentiment analysis and topic extraction",
    "Runtime dev-mock mode for local testing and admin toggle",
    "Structured fact memory that captures user-specific details (name, favorites, attributes) from conversations",
    "Profile question history and discovery flow (definition-driven)",
    "Embedding-backed semantic matching for paraphrase handling",
    "Inline non-modal confirmation flow for mid-confidence facts",
    "In-chat Profile UI to view and remove stored facts",
    "Telemetry collection for fact autosave/suggestion/confirm/reject/delete events",
    "Admin telemetry UI (dashboard) to inspect recent events",
    "Password-protected profiles that sync identities across devices",
    "Role-aware UI (admin vs user) with gated controls",
    "Authenticated UI boot flow that waits for a valid session before enabling interactions",
    "Relationship tracking system for user connections and shared interests",
    "Production hardening: rate limiting, memory leak prevention, service health monitoring",
    "Robust error handling with graceful fallbacks",
    "Contextual mood/news injection (only on direct questions, not casual mentions)",
    "External Qdrant cloud database integration with API key authentication",
    "Vector size validation and automatic adjustment for embedding compatibility"
  ],
  "apiEndpoints": [
    {"endpoint": "/api/chat", "method": "POST", "description": "Main chat interface (rate limited, requires user session headers)"},
    {"endpoint": "/api/mood", "method": "GET", "description": "Check AI emotional state and topics"},
    {"endpoint": "/api/process-news", "method": "GET/POST", "description": "Trigger manual news processing (admin headers required)"},
    {"endpoint": "/api/admin/dev-mock", "method": "GET/POST", "description": "View and toggle development mock mode (admin only)"},
    {"endpoint": "/api/admin/telemetry", "method": "GET", "description": "Fetch recent telemetry events (admin only)"},
    {"endpoint": "/api/users/:userId/profile", "method": "GET", "description": "Retrieve user profile"},
    {"endpoint": "/api/users/:userId/relationships", "method": "GET", "description": "Get user relationships and shared interests (auth required)"},
    {"endpoint": "/api/profile/confirm-fact", "method": "POST", "description": "Confirm or reject a candidate fact (requires auth)"},
    {"endpoint": "/api/profile/remove-fact", "method": "POST", "description": "Remove a stored fact from a profile (requires auth)"},
    {"endpoint": "/admin", "method": "GET", "description": "Serve admin dashboard to authenticated admins"},
    {"endpoint": "/", "method": "GET", "description": "Redirects to `/chat` once authentication completes"},
    {"endpoint": "/chat", "method": "GET", "description": "Serve chat UI from webhook API (same origin)"}
  ],
  "nextSteps": [
    "Aggregate telemetry and provide per-fact metrics",
    "Add admin UI for tuning embedding thresholds and priorities (enhance current dashboard)",
    "Implement privacy consent flows for high-sensitivity facts",
    "Add automated tests for extraction and confirmation flows",
    "Consider Neo4j migration for advanced relationship queries when JSON approach hits limits",
    "Deploy production monitoring and alerting"
  ],
  "statusDetails": {
    "externalServices": {
      "qdrant": "Specify QDRANT_URL (e.g. https://cluster-id.region.aws.cloud.qdrant.io) and QDRANT_API_KEY - required",
      "llm": "Specify LLM_URL (OpenAI-compatible) - required if dev-mock is disabled",
      "embeddings": "Specify EMBEDDING_URL (OpenAI-compatible) - required if dev-mock is disabled",
      "searxng": "Optional - URL for RSS parsing if used"
    },
    "requiredEnv": [
      "LLM_URL",
      "EMBEDDING_URL", 
      "QDRANT_URL",
      "QDRANT_API_KEY",
      "PORT (optional)",
      "DEV_MOCK (optional)",
      "PARAPHRASE_QUESTIONS (optional)",
      "ASK_COOLDOWN_MS (optional)",
      "EMBED_AUTO_SAVE_SIM (optional)",
      "EMBED_CONFIRM_SIM (optional)"
    ],
    "authentication": {
      "description": "`/` and `/chat` wait for a valid session (userId + token) before opening WebSockets or hitting `/api/chat`, and every admin endpoint (`/api/process-news`, `/api/admin/*`, `/admin`) rejects requests without `X-User-Id`/`X-Auth-Token`.",
      "notes": "Ensure the client stores the session from `/api/auth/login` or `/api/auth/register` so the UI can complete its boot sequence. Admin dashboards rely on the same token via query params to `/admin`."
    },
    "productionReadiness": {
      "rateLimiting": "30 requests per minute per user on chat endpoint",
      "memoryManagement": "Automatic cleanup of stale WebSocket connections every 10 minutes",
      "errorHandling": "Robust JSON parsing with fallbacks for malformed LLM responses",
      "serviceHealth": "Graceful fallback to dev-mock when external services fail",
      "configValidation": "Startup validation of critical environment variables"
    },
    "notes": "This project can run in a local dev-mock mode (DEV_MOCK=true or via admin toggle) for testing without external LLM/embedding services. For production, configure real services and disable dev-mock. The system now uses external Qdrant cloud database with API key authentication and automatic vector size validation. The system is production-ready with comprehensive error handling and monitoring."
  },
  "lastUpdated": "2024-12-04T18:00:00Z"
}
